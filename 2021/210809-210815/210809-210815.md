# 실전프로젝트 3주차
<image src ="https://user-images.githubusercontent.com/77604219/129482866-5cf92719-e094-4a5b-929f-64dfa9db70e5.png" width="900">

## 배운점/구현
1. 환경변수
    - 환경변수에 대해 공부하고, 프로젝트를 개발, 테스트, 프로덕션 환경에서 구분해서 실행시키는 코드를 작성했다. path와 --dirname, process.cwd()의 개념이 생각보다 이해하기 어려웠다. cross-env를 이용해 맥os와 윈도우 모든 환경에서 개발자들이 코드를 실행할 수 있게 했다.
2. 레벨업 시스템
    - 이 부분을 만들며, mongoose ORM을 제대로 이해하고, 사용하기 시작했다. statics, methods, pre, post 중 어느 것을 사용할지 결정하는데 힘이 들었다.
    - 처음에는 데이터베이스를 줄이기 위해 '누적 경험치'만 데이터베이스에 저장하고 virtual로 '레벨'을 보여주려고 했다. 하지만, '누적경험치'에서 '레벨'을 구하기 위해서는, '누적 경험치'가 단계별 '레벨'에 해당하는지 1부터 검사를 해야해서 리소스 낭비가 심했고, 결국에는 '레벨'을 데이터베이스에 저장했다. (데이터를 주고 시간을 취했다.)
    - 좋아요를 취소하거나, 리뷰를 삭제했을떄, 경험치를 어떻게 취급할지도 생각해야했다. 취소 시 레벨에는 영향을 미치지 않고, 경험치를 마이너스로 입력되도록했다.
3. 프로필 이미지 지급
    - 특정 레벨이 되면 이미지를 유저에게 주도록했다. treasure라는 boolean 값 데이터베이스에 저장했다. 처음에는 levelup static 함수의 return값을 boolean값으로 프론트에 보내주었지만, 프론트에서 항상 확인할 값이 필요하다고 해서 데이터베이스에 저장하게 되었다. 이값은 특정레벨이 되었을때, true로 변하고, 프로필이미지를 받는 라우터에서 false로 다시 변하게 된다.
4. 팔로우 시스템
    - 팔로우의 행위 자체를 저장하는 데이터 스키마를 만들었다. 처음에는 유저 스키마에 해당 user를 팔로우를 하고 있는 userId를 저장하는 array 프로퍼티를 추가하려했다. 하지만 이러한 방식은 유저와 유저의 관계를 정의하지 못하고, 유저 다큐먼트의 데이터의 양이 늘어나는 단점이 존재했다. 또한 유저스키마에 종속되어 있기에 삭제나 데이터의 변경이 자유롭지 못했다. 그래서 sender와 receiver라는 프로퍼티를 가진 follow schema를 만들고, follow 정보가 필요할때, 이 다큐먼트를 사용하도록 했다.

## 느낀점
1. scope에 대한 생각
    - 첫 술에 배부를 수 없다. 물리적으로 표현되는 서비스에 대한 기획은 많이 해봤다고 자부했다. 하지만 6주 동안 6명의 프로그래머가 온전한 서비스를 만들기 위해서는 어떤 주제가 적합하고, 어느 정도의 scope가 적절할지 고려하지 못했던 것 같다. 너무 많은 기능이 서비스에 탑재되고 있는게 아닌가 하는 생각이 든다. MVP 이후로 추가될 기능도 중요하지만, 지금까지 짜온 코드를 클린 코딩, 추상화하고, 데이터베이스와 검색 속도 개선, 보안에 신경을 써야한다.
2. 중간 평가
    - 이번주차 마지막 일정으로, 항해99팀에서 튜터님들을 모셔와 중간평가를 진행했다. 중간 평가 후 느낀점은
        1. 보안과 속도, 리소스에 대한 고민을 하자.
        2. 해쉬태그, 컬렉션이 우리조의 장점이다. 코드리뷰 후 더 좋은 프로덕트로 개선해 나가자.
        3. 좋아요, 해쉬태그, 컬렉션 등 데이터 관리를 어떻게 할 것인가? 이에 관련한 피처를 추가할 수 있는 방향을 생각해보자
        4. 잘하는 조들은 진짜 잘하더라. 나도 잘할거다. 더더더더더잘할래.
